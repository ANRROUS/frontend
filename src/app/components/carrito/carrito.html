<div class="container my-5">
    <h2 class="text-center mb-4 fw-bold">Mi lista de carrito</h2>
    <div class="row">
        <!-- Lista de productos añadidos al carrito -->
        <div class="col-md-8">
            <div class="card-carrito bg-white mb-3">
                <div class="row mb-2 align-items-center fw-semibold">
                    <div class="col-2 text-start"></div>
                    <div class="col-3 text-start">PRODUCTO</div>
                    <div class="col-2 text-start">P.UNIT.</div>
                    <div class="col-2 text-start">CANT.</div>
                    <div class="col-2 text-start">IMPORTE</div>
                    <div class="col-1 text-start"></div>
                </div>
                <div class="row mb-2 align-items-center" *ngFor="let detalle of carritoItems">
                    <div class="col-2">
                        <img [src]="detalle.producto.imagen || 'assets/img/default.png'" alt="Imagen"
                            class="img-fluid rounded" style="max-width:70px;">
                    </div>
                    <div class="col-3">{{ detalle.producto.nombre }}</div>
                    <div class="col-2">${{ detalle.precio_unitario | number:'1.2-2' }}</div>
                    <div class="col-2">
                    <input type="number" min="1" [(ngModel)]="detalle.cantidad" class="form-control form-control-sm d-inline w-75"
                            (change)="actualizarCarrito(detalle.producto.id, detalle.cantidad)">
                    </div>
                    <div class="col-2 fw-semibold">${{ detalle.subtotal | number:'1.2-2' }}</div>
                    <div class="col-1">
                        <button class="btn btn-sm btn-link text-primary p-0"
                                (click)="eliminarDelCarrito(detalle.producto.id)">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Detalles Compra -->
        <div class="col-md-4">
            <div class="card-carrito bg-white p-3">
                <h5>Total de la Compra</h5>
                <hr>
                <div class="d-flex justify-content-between">
                    <span>Subtotal:</span>
                    <span>${{ total | number:'1.2-2' }}</span>
                </div>
                <div class="d-flex justify-content-between">
                    <span>Envío:</span><span>Gratis</span>
                </div>
                <hr>
                <div class="d-flex justify-content-between fw-bold">
                    <span>Total:</span>
                    <span>${{ total | number:'1.2-2' }}</span>
                </div>
                <button class="btn btn-primary w-100 mt-4" (click)="procesarCompra()">Realizar la compra</button>
            </div>
        </div>

        <div *ngIf="mensaje" class="alert alert-success text-center mt-4">
            {{ mensaje }}
        </div>
        <div *ngIf="seguimientoActivo" class="mt-5">
  <h5 class="text-center mb-4 fw-bold">Seguimiento de tu pedido</h5>

  <div class="progress-tracker">
    <div *ngFor="let etapa of etapasSeguimiento; let i = index" class="step" [class.active]="i <= etapaActual">
      <div class="step-icon">
        <i class="fas" [ngClass]="{
          'fa-check-circle': i < etapaActual,
          'fa-spinner fa-spin': i === etapaActual,
          'fa-circle': i > etapaActual
        }"></i>
      </div>
      <div class="step-label">{{ etapa }}</div>
      <div *ngIf="i < etapasSeguimiento.length - 1" class="step-line"></div>
    </div>
  </div>
</div>

    </div>
</div>